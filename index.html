<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AgritechIoT Dashboard with Voice Assistant</title>
<style>
body {
font-family: "Poppins", sans-serif;
background: #fafbf7;
color: #333;
margin: 0;
text-align: center;
}

header {
background-color: #9CD25F;
color: white;
padding: 20px;
font-size: 24px;
box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

nav {
background-color: #f8f7dc;
padding: 10px;
}

nav a {
color:#9CD25F;
text-decoration: none;
margin: 0 15px;
font-weight: 500;
}

.container {
margin-top: 40px;
}

.card {
display: inline-block;
background: white;
padding: 20px;
margin: 20px;
box-shadow: 0 4px 8px rgba(0,0,0,0.1);
width: 250px;
}

h2 { color: #9CD25F; }

select {
margin-top: 10px;
padding: 8px;
border: 1px solid #ccc;
}

footer {
background-color: #f8f7dc;
color: #333;
padding: 10px;
position: fixed;
bottom: 0;
width: 100%;
font-size: 14px;
}


#notification {
display: none;
position: fixed;
top: 15px;
right: 15px;
background-color: #ff6961;
color: white;
padding: 15px 20px;
border-radius: 8px;
box-shadow: 0 4px 8px rgba(0,0,0,0.2);
z-index: 9999;
font-weight: 500;
text-align: left;
max-width: 300px;
}

#notification button {
background: transparent;
border: none;
color: white;
font-size: 16px;
margin-left: 10px;
cursor: pointer;
}


#micBtn {
margin-top: 20px;
background-color: #9CD25F;
border: none;
color: white;
padding: 12px 25px;
border-radius: 6px;
font-size: 16px;
cursor: pointer;
box-shadow: 0 3px 6px rgba(0,0,0,0.2);
}

#micBtn.listening {
background-color: #7cb342;
}
</style>
</head>
<body>

<header id="header">
IoT Environment Dashboard
</header>

<nav>
<a href="index.html" id="nav-dashboard">Dashboard</a>
<a href="about.html" id="nav-about">About Project</a>
</nav>

<div class="container">
<div class="card">
<h2 id="temp-title">Temperature</h2>
<p id="temp">-- ¬∞C</p>
</div>
  
<div class="card">
<h2 id="hum-title">Humidity</h2>
<p id="hum">-- %</p>
</div>
</div>

<div>
<label for="lang"> Language:</label>
<select id="lang">
<option value="en">English</option>
<option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
<option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
</select>
</div>

<button id="micBtn">üé§ Ask Temperature</button>

<div id="notification">
Temperature exceeding recommended limit
<button onclick="dismissNotification()">‚úñ</button>
</div>

<footer id="footer">
Robotopia Project 2025 by Team DAV BGPM
</footer>

<script>
const channelID = "3118657";
const readAPIKey = "UH1LTJ16P4A5RXR4";

let currentTemp = "--";
let currentHum = "--";
let currentLang = "en";

const translations = {
en: {
header: "IoT Environment Dashboard",
navDashboard: "Dashboard",
navAbout: "About Project",
tempTitle: "Temperature",
humTitle: "Humidity",
footer: "Robotopia Project 2025 by Team DAV BGPM",
askPhrases: ["what is the temperature", "temperature", "humidity"],
response: (t, h) => `The current temperature is ${t} degrees Celsius and humidity is ${h} percent.`
},
hi: {
header: "‡§Ü‡§à‡§ì‡§ü‡•Ä ‡§™‡§∞‡•ç‡§Ø‡§æ‡§µ‡§∞‡§£ ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°",
navDashboard: "‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°",
navAbout: "‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç",
tempTitle: "‡§§‡§æ‡§™‡§Æ‡§æ‡§®",
humTitle: "‡§®‡§Æ‡•Ä",
footer: "Robotopia Project 2025 by Team DAV BGPM",
askPhrases: ["‡§§‡§æ‡§™‡§Æ‡§æ‡§® ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à", "‡§®‡§Æ‡•Ä ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à", "‡§§‡§æ‡§™‡§Æ‡§æ‡§® ‡§¨‡§§‡§æ‡§ì"],
response: (t, h) => `‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§§‡§æ‡§™‡§Æ‡§æ‡§® ${t} ‡§°‡§ø‡§ó‡•ç‡§∞‡•Ä ‡§∏‡•á‡§≤‡•ç‡§∏‡§ø‡§Ø‡§∏ ‡§î‡§∞ ‡§®‡§Æ‡•Ä ${h} ‡§™‡•ç‡§∞‡§§‡§ø‡§∂‡§§ ‡§π‡•à‡•§`
},
ta: {
header: "‡Æê‡Æì‡Æü‡Æø ‡Æö‡ØÅ‡Æ±‡Øç‡Æ±‡ØÅ‡Æö‡Øç‡Æö‡ØÇ‡Æ¥‡Æ≤‡Øç ‡Æü‡Ææ‡Æ∑‡Øç‡Æ™‡Øã‡Æ∞‡Øç‡Æü‡ØÅ",
navDashboard: "‡Æü‡Ææ‡Æ∑‡Øç‡Æ™‡Øã‡Æ∞‡Øç‡Æü‡ØÅ",
navAbout: "‡Æ™‡Øç‡Æ∞‡Ææ‡Æú‡ØÜ‡Æï‡Øç‡Æü‡Øç ‡Æ™‡Æ±‡Øç‡Æ±‡Æø",
tempTitle: "‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡Æ®‡Æø‡Æ≤‡Øà",
humTitle: "‡Æà‡Æ∞‡Æ™‡Øç‡Æ™‡Æ§‡ÆÆ‡Øç",
footer: "Robotopia Project 2025 by Team DAV BGPM",
askPhrases: ["‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡Æ®‡Æø‡Æ≤‡Øà ‡Æé‡Æ©‡Øç‡Æ©", "‡Æà‡Æ∞‡Æ™‡Øç‡Æ™‡Æ§‡ÆÆ‡Øç ‡Æé‡Æ©‡Øç‡Æ©", "‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡Æ®‡Æø‡Æ≤‡Øà ‡Æö‡Øä‡Æ≤‡Øç‡Æ≤‡ØÅ"],
response: (t, h) => `‡Æ§‡Æ±‡Øç‡Æ™‡Øã‡Æ§‡Øà‡ÆØ ‡Æµ‡ØÜ‡Æ™‡Øç‡Æ™‡Æ®‡Æø‡Æ≤‡Øà ${t} ‡Æü‡Æø‡Æï‡Æø‡Æ∞‡Æø ‡Æö‡ØÜ‡Æ≤‡Øç‡Æö‡Æø‡ÆØ‡Æ∏‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æà‡Æ∞‡Æ™‡Øç‡Æ™‡Æ§‡ÆÆ‡Øç ${h} ‡Æö‡Æ§‡Æµ‡ØÄ‡Æ§‡ÆÆ‡Øç.`
}
};


function updateLanguage(lang) {
currentLang = lang;
document.getElementById("header").textContent = translations[lang].header;
document.getElementById("nav-dashboard").textContent = translations[lang].navDashboard;
document.getElementById("nav-about").textContent = translations[lang].navAbout;
document.getElementById("temp-title").textContent = translations[lang].tempTitle;
document.getElementById("hum-title").textContent = translations[lang].humTitle;
document.getElementById("footer").textContent = translations[lang].footer;
}


function showNotification() {
document.getElementById("notification").style.display = "block";
}
function dismissNotification() {
document.getElementById("notification").style.display = "none";
}


async function fetchData() {
try {
const response = await fetch(`https://api.thingspeak.com/channels/${channelID}/feeds.json?api_key=${readAPIKey}&results=1`);
const data = await response.json();
const latest = data.feeds[data.feeds.length - 1];
const temp = parseFloat(latest.field1);
const hum = latest.field2;

currentTemp = temp;
currentHum = hum;

document.getElementById("temp").textContent = temp + " ¬∞C";
document.getElementById("hum").textContent = hum + " %";

if (temp > 32) {
showNotification();
} else {
dismissNotification();
}
} catch (err) {
console.error("Error fetching data:", err);
}
}

fetchData();
setInterval(fetchData, 15000);

const micBtn = document.getElementById("micBtn");
let recognition;

if ('webkitSpeechRecognition' in window) {
recognition = new webkitSpeechRecognition();
recognition.continuous = false;
recognition.lang = "en-IN";
recognition.interimResults = false;

micBtn.addEventListener("click", () => {
recognition.lang = currentLang === "hi" ? "hi-IN" :
                   currentLang === "ta" ? "ta-IN" : "en-IN";
recognition.start();
micBtn.classList.add("listening");
micBtn.textContent = "üéß Listening...";
});

recognition.onresult = (event) => {
const transcript = event.results[0][0].transcript.toLowerCase();
micBtn.classList.remove("listening");
micBtn.textContent = "üé§ Ask Temperature";
handleVoiceCommand(transcript);
};

recognition.onerror = () => {
micBtn.classList.remove("listening");
micBtn.textContent = "üé§ Ask Temperature";
};
} else {
micBtn.textContent = "Voice not supported";
micBtn.disabled = true;
}


function handleVoiceCommand(command) {
const { askPhrases, response } = translations[currentLang];
if (askPhrases.some(p => command.includes(p))) {
speak(response(currentTemp, currentHum));
} else {
const msg = currentLang === "hi" ? "‡§Æ‡•à‡§Ç ‡§∏‡§Æ‡§ù ‡§®‡§π‡•Ä‡§Ç ‡§™‡§æ‡§Ø‡§æ‡•§" :
            currentLang === "ta" ? "‡Æé‡Æ©‡Æï‡Øç‡Æï‡ØÅ ‡Æ™‡ØÅ‡Æ∞‡Æø‡ÆØ‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà." :
            "I didn‚Äôt understand that.";
speak(msg);
}
}

function speak(text) {
const utterance = new SpeechSynthesisUtterance(text);
utterance.lang = currentLang === "hi" ? "hi-IN" :
                 currentLang === "ta" ? "ta-IN" : "en-IN";
speechSynthesis.speak(utterance);
}

document.getElementById("lang").addEventListener("change", function() {
updateLanguage(this.value);
fetchData(); 
});

updateLanguage("en");
</script>

</body>
</html>
