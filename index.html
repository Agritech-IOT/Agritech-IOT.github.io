<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DHT11 IoT Dashboard</title>
<style>
body {
font-family: "Poppins", sans-serif;
background: #fafbf7;
color: #333;
margin: 0;
text-align: center;
}

header {
background-color: #C7FFA2;
color: white;
padding: 20px;
font-size: 24px;
box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

nav {
background-color: #f8f7dc;
padding: 10px;
}

nav a {
color: #C7FFA2;
text-decoration: none;
margin: 0 15px;
font-weight: 500;
}

.container {
margin-top: 40px;
}

.card {
display: inline-block;
background: white;
padding: 20px;
border-radius: 12px;
margin: 20px;
box-shadow: 0 4px 8px rgba(0,0,0,0.1);
width: 250px;
}

h2 { color: #C7FFA2; }

#ai-box {
max-width: 600px;
margin: 40px auto;
background: #ffffff;
padding: 20px;
border-radius: 12px;
box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

select {
margin-top: 10px;
padding: 8px;
border-radius: 6px;
border: 1px solid #ccc;
}

footer {
background-color: #f8f7dc;
color: #333;
padding: 10px;
position: fixed;
bottom: 0;
width: 100%;
font-size: 14px;
}
</style>
</head>
<body>

<header id="header">
IoT Environment Dashboard
</header>

<nav>
<a href="index.html" id="nav-dashboard">Dashboard</a>
<a href="about.html" id="nav-about">About Project</a>
</nav>

<div class="container">
<div class="card">
<h2 id="temp-title">Temperature</h2>
<p id="temp">-- °C</p>
</div>
  
<div class="card">
<h2 id="hum-title">Humidity</h2>
<p id="hum">-- %</p>
</div>
</div>

<div id="ai-box">
<h2 id="ai-title">AI Insights</h2>
<p id="ai-text">Loading AI analysis...</p>
</div>

<div>
<label for="lang"> Language:</label>
<select id="lang">
<option value="en">English</option>
<option value="hi">हिन्दी</option>
<option value="ta">தமிழ்</option>
</select>
</div>

<footer id="footer">
Robotopia Project 2025 by Team DAV BGPM
</footer>

<script>
const channelID = "3118657";
const readAPIKey = "UH1LTJ16P4A5RXR4";
const geminiAPIKey = "AIzaSyCBERPpsVpvqSwDrfmF-Jm5X60fw3mJ-kU";

  
const translations = {
en: {
header: " IoT Environment Dashboard",
navDashboard: "Dashboard",
navAbout: "About Project",
tempTitle: "Temperature",
humTitle: "Humidity",
aiTitle: "AI Insights",
aiText: "Loading AI analysis...",
footer: "Robotopia Project 2025 by Team DAV BGPM"
},
hi: {
header: "आईओटी पर्यावरण डैशबोर्ड",
navDashboard: "डैशबोर्ड",
navAbout: "परियोजना के बारे में",
tempTitle: "तापमान",
humTitle: "नमी",
aiTitle: "एआई विश्लेषण",
aiText: "एआई विश्लेषण लोड हो रहा है...",
footer: "Robotopia Project 2025 by Team DAV BGPM"
},
ta: {
header: "ஐஓடி சுற்றுச்சூழல் டாஷ்போர்டு",
navDashboard: "டாஷ்போர்டு",
navAbout: "ப்ராஜெக்ட் பற்றி",
empTitle: "வெப்பநிலை",
humTitle: " ஈரப்பதம்",
aiTitle: "ஏஐ பகுப்பாய்வு",
aiText: "ஏஐ பகுப்பாய்வு ஏற்றப்படுகிறது...",
footer: "Robotopia Project 2025 by Team DAV BGPM"
}
};

function updateLanguage(lang) {
document.getElementById("header").textContent = translations[lang].header;
document.getElementById("nav-dashboard").textContent = translations[lang].navDashboard;
document.getElementById("nav-about").textContent = translations[lang].navAbout;
document.getElementById("temp-title").textContent = translations[lang].tempTitle;
document.getElementById("hum-title").textContent = translations[lang].humTitle;
document.getElementById("ai-title").textContent = translations[lang].aiTitle;
document.getElementById("ai-text").textContent = translations[lang].aiText;
document.getElementById("footer").textContent = translations[lang].footer;
}

async function fetchData() {
try {
const response = await fetch(`https://api.thingspeak.com/channels/${channelID}/feeds.json?api_key=${readAPIKey}&results=1`);
const data = await response.json();
const latest = data.feeds[data.feeds.length - 1];
const temp = latest.field1;
const hum = latest.field2;

document.getElementById("temp").textContent = temp + " °C";
document.getElementById("hum").textContent = hum + " %";

getAIInsights(temp, hum);
} catch (err) {
console.error("Error fetching data:", err);
document.getElementById("ai-text").textContent = "Error fetching sensor data.";
}
}

async function getAIInsights(temp, hum) {
const lang = document.getElementById("lang").value;
let prompt = "";

if(lang === "hi") {
prompt = `इस तापमान ${temp}°C और नमी ${hum}% के आधार पर वातावरण के बारे में एक छोटा विश्लेषण लिखें।`;
} else if(lang === "ta") {
prompt = `இந்த வெப்பநிலை ${temp}°C மற்றும் ஈரப்பதம் ${hum}% அடிப்படையில் சுற்றுச்சூழல் பற்றிய ஒரு சுருக்கமான பகுப்பாய்வை எழுதுக.`;
} else {
prompt = `Based on temperature ${temp}°C and humidity ${hum}%, give a short analysis of the environment.`;
}

try {
const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${geminiAPIKey}`, {
method: "POST",
headers: { "Content-Type": "application/json" },
body: JSON.stringify({
prompt: prompt,
max_output_tokens: 150
})
});

const result = await response.json();
const aiText = result.candidates?.[0]?.content?.parts?.[0]?.text || "AI could not generate insight.";
document.getElementById("ai-text").textContent = aiText;
} catch (error) {
console.error("Error fetching AI insights:", error);
document.getElementById("ai-text").textContent = "Error loading AI insights.";
}
}

fetchData();
setInterval(fetchData, 15000);
document.getElementById("lang").addEventListener("change", function() {
updateLanguage(this.value);
fetchData(); 
});

updateLanguage("en");
</script>

</body>
</html>
